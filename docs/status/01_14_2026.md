# Inventory MCP Server - Status Report

**Date:** January 14, 2026 (Evening Update)
**Status:** Container Deployment Complete, Mobile UI In Progress
**Version:** 0.2.1
**Repository:** https://git.maxseiner.casa/ron-maxseiner/inventory-mcp.git
**Branch:** main
**Commit:** a86e9db

---

## Executive Summary

Significant progress on deployment and mobile experience:
1. **Docker Deployment** - Container image built and deployed via Gitea Actions CI/CD
2. **MCP SSE Endpoint** - Remote Claude Desktop access via SSE transport
3. **Mobile UI Improvements** - In progress, some issues remain
4. **Version Display** - Added to sidebar for deployment verification

---

## Completed Today (Evening Session)

### Docker Container Deployment
- Multi-stage Dockerfile with non-root user (appuser, UID 1000)
- docker-compose.yml with bind mounts for data persistence
- Gitea Actions CI/CD workflow (`.gitea/workflows/build-container.yml`)
- Container registry: `git.maxseiner.casa/ron-maxseiner/inventory-mcp:latest`

### MCP SSE Endpoint
- New entry point: `inventory-mcp-sse` on port 8081
- Enables remote Claude Desktop connections via `mcp-remote` proxy
- Routes: `/health`, `/sse`, `/messages/`

### MCP Tool Changes
- **Removed** 6 image-related tools to prevent context overflow:
  - `get_bin_images`, `add_bin_image`, `remove_bin_image`
  - `set_primary_bin_image`, `add_image_to_session`, `extract_items_from_image`
- Images now managed via Web UI only

### Web UI Improvements
- Clickable breadcrumb navigation on bin detail page
- Clickable path components on item detail page
- Version number displayed in sidebar footer
- Increased max image upload size: 10MB → 15MB

### Mobile UI (Partial)
- Image lightbox code added (not working yet)
- Touch event handlers added
- Action buttons repositioned (no longer hidden in overlay)

---

## Current Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                    Docker Container                          │
│            git.maxseiner.casa/ron-maxseiner/inventory-mcp   │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │ inventory-web│  │inventory-mcp │  │inventory-mcp │       │
│  │   (web UI)   │  │   (stdio)    │  │    -sse      │       │
│  │   Port 8080  │  │  No port     │  │  Port 8081   │       │
│  └──────────────┘  └──────────────┘  └──────────────┘       │
│         │                                    │               │
│         └────────────┬───────────────────────┘               │
│                      ▼                                       │
│              ┌──────────────┐                                │
│              │   SQLite DB  │                                │
│              │  + Images    │                                │
│              └──────────────┘                                │
└─────────────────────────────────────────────────────────────┘
```

**Container Commands:**
- `web` - Start Web UI server
- `mcp` - Start MCP stdio server
- `mcp-sse` - Start MCP SSE server

---

## Known Issues (To Fix)

### 1. Image Lightbox Not Working
**Symptom:** Cursor changes to magnifying glass on hover, but clicking does nothing.
**Likely Cause:** JavaScript event handler not firing or error in lightbox code.
**Investigation Needed:** Check browser console for JS errors.

### 2. Mobile Hamburger Menu Not Working
**Symptom:** Button shows visual feedback (lighter square) but sidebar doesn't open.
**Likely Cause:** JavaScript `openSidebar()` function not executing or CSS transition issue.
**Investigation Needed:** Check if sidebar element exists, check for JS errors.

### 3. Mobile Navigation Between Pages
**Symptom:** Can't switch between Search/Browse/History on mobile.
**Related To:** Hamburger menu issue - if menu doesn't open, can't access nav links.

---

## TODO / Roadmap

### High Priority - Bug Fixes
| Issue | Description | Complexity |
|-------|-------------|------------|
| Image lightbox | Click on image should open full-size view with zoom | Medium |
| Hamburger menu | Mobile sidebar should open/close on tap | Medium |
| Mobile navigation | Nav links should work on touch devices | Low |

### High Priority - Item Actions
| Action | Description | Complexity |
|--------|-------------|------------|
| **Add Quantity** | Increase item count with history entry | Medium |
| **Use Item** | Decrease item count with history entry | Medium |
| **Edit Item** | Modify name, description, notes, quantity | Medium |
| **Move Item** | Relocate item to different bin | Medium |

### Medium Priority - Semantic Search
| Feature | Description | Complexity |
|---------|-------------|------------|
| **Embedding Generation** | Generate vector embeddings for items | Medium |
| **Vector Storage** | Store embeddings in SQLite or separate vector DB | Medium |
| **Semantic Query** | "computer parts" finds "case fan", "DDR4 memory" | High |

**Why Semantic Search Helps:**
- Current FTS5 search is keyword-based (exact/prefix matching)
- "computer parts" won't match "case fan" because words don't overlap
- Semantic search uses meaning/context, not just keywords
- Options: Claude embeddings API, OpenAI embeddings, local model (sentence-transformers)

### Low Priority - Future Enhancements
| Feature | Description |
|---------|-------------|
| Create bins from web UI | Add new bins/locations via web interface |
| Bulk operations | Select multiple items for move/delete |
| PWA support | Installable mobile app experience |
| Barcode scanning | Camera-based UPC lookup |
| Data export | CSV/JSON export for backup/migration |

---

## Configuration Reference

### Environment Variables
| Variable | Default | Description |
|----------|---------|-------------|
| `INVENTORY_DATABASE_PATH` | `data/inventory.db` | SQLite database location |
| `INVENTORY_IMAGE_BASE_PATH` | `data/images` | Image storage directory |
| `INVENTORY_WEB_PORT` | `8080` | Web UI port |
| `INVENTORY_WEB_HOST` | `0.0.0.0` | Web UI bind address |
| `INVENTORY_MCP_SSE_PORT` | `8081` | MCP SSE port |
| `INVENTORY_MCP_SSE_HOST` | `0.0.0.0` | MCP SSE bind address |
| `INVENTORY_MAX_IMAGE_SIZE_BYTES` | `15728640` | Max upload (15MB) |
| `INVENTORY_CLAUDE_API_KEY` | None | For vision extraction |

### Claude Desktop MCP SSE Configuration
```json
{
  "mcpServers": {
    "inventory": {
      "command": "npx",
      "args": [
        "-y",
        "mcp-remote",
        "http://your-server:8081/sse",
        "--allow-http"
      ]
    }
  }
}
```

---

## Deployment Commands

```bash
# Pull latest image
docker compose pull

# Restart with new image
docker compose up -d

# Check logs
docker compose logs -f

# Verify version in UI
# Open browser → sidebar shows "v0.2.1"
```

---

## Files Changed Today (Evening)

| File | Change |
|------|--------|
| `src/inventory_mcp/__init__.py` | Version bump to 0.2.1 |
| `src/inventory_mcp/config.py` | MCP SSE settings, 15MB max image |
| `src/inventory_mcp/mcp_sse.py` | NEW: SSE server |
| `src/inventory_mcp/server.py` | Removed 6 image tools |
| `src/inventory_mcp/web/app.py` | Added version to templates |
| `src/inventory_mcp/web/static/app.js` | Lightbox, touch handlers |
| `src/inventory_mcp/web/static/app.css` | Touch improvements |
| `src/inventory_mcp/web/templates/base.html` | Version in sidebar |
| `src/inventory_mcp/web/templates/bin.html` | Lightbox, breadcrumbs |
| `src/inventory_mcp/web/templates/item.html` | Lightbox, path links |
| `Dockerfile` | Multi-stage build |
| `docker-compose.yml` | Service definition |
| `docker-entrypoint.sh` | web/mcp/mcp-sse modes |
| `.gitea/workflows/build-container.yml` | CI/CD pipeline |

---

## Session Statistics

| Metric | Value |
|--------|-------|
| Commits today | 8 |
| Version | 0.1.0 → 0.2.1 |
| Container image | Deployed to Gitea registry |
| MCP tools removed | 6 (image-related) |

---

*Report updated: January 14, 2026 (Evening)*
